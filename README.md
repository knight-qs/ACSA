# ACSA

1. 在NCBI比对蛋白质序列，获取蛋白质家族，如bla_500pr.fasta文件

2. 使用在线工具，联配各蛋白质序列，如ali_500pr.fa文件

3. 使用R脚本中的第一部分，将联配文件ali_500pr.fa文件转化为phylip格式，如500pr.phy

4. 使用文本编辑器多光标编辑功能，如notepad++，将各行开头删除干净，如protein.txt

5. 在bla_500pr.fasta文件中复制粘贴自己的蛋白质序列，生成新文件，如query_protein.txt

6. 运行ACSA.py，筛选家族蛋白中保守的残基进化位点

7. 结果文件amino_acid_existed.csv，所有位点(以目标蛋白为基准)氨基酸种类、频数统计，如
```
1
"(422, 'M')","(72, '-')","(1, 'X')","(1, 'W')","(1, 'V')","(1, 'T')","(1, 'G')","(1, 'D')"

2
"(414, 'K')","(55, '-')","(17, 'M')","(3, 'T')","(3, 'S')","(2, 'N')","(2, 'I')","(1, 'V')","(1, 'R')","(1, 'G')","(1, 'D')"

3
"(400, 'K')","(55, '-')","(37, 'R')","(2, 'S')","(2, 'N')","(1, 'Q')","(1, 'M')","(1, 'I')","(1, 'G')"

4
"(322, 'R')","(52, '-')","(34, 'N')","(27, 'Q')","(16, 'S')","(11, 'L')","(11, 'I')","(8, 'T')","(6, 'K')","(4, 'V')","(3, 'H')","(3, 'A')","(2, 'M')","(1, 'G')"

5
"(309, 'V')","(78, 'L')","(53, '-')","(46, 'I')","(3, 'F')","(2, 'W')","(1, 'Y')","(1, 'T')","(1, 'Q')","(1, 'P')","(1, 'N')","(1, 'M')","(1, 'D')","(1, 'C')","(1, 'A')"

```

8. 结果文件amino_acid_filted.csv, 筛选目标蛋白对应的氨基酸频数并非最大的位点，如
```
site3    here is R:37    K:400 -:55 
site4    here is Q:27    R:322 -:52 N:34 
site5    here is L:78    V:309 
site6    here is F:28    L:320 I:58 -:48 
site7    here is T:68    A:354 
site9    here is S:28    C:399 -:52 
```

9. 结果文件query_results.csv，筛选出的氨基酸种类及对应频数，下游R脚本绘制热图所需数据文件

10. 结果文件heatmap_sites.csv，筛选出的蛋白质位点，下游R脚本绘制热图所需数据文件

11. R脚本第二部分绘制热图

![image](https://github.com/knight-qs/ACSA/blob/main/fig/a_c_count_heatmap.jpg)
